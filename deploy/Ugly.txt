<!DOCTYPE html>
<html>
<head>
    <title>custom-grid-with-deep-export-1.3.10</title>
    <!--  (c) 2017 CA Technologies.  All Rights Reserved. -->
    <!--  Build Date: Thu Aug 19 2021 09:39:59 GMT-0600 (Mountain Daylight Time) -->

    <script type="text/javascript">
        var APP_BUILD_DATE = "Thu Aug 19 2021 09:39:59 GMT-0600 (Mountain Daylight Time)";
        var CHECKSUM = 82872624384;
    </script>

    <script type="text/javascript" src="/apps/2.1/sdk.js"></script>
    <!-- our highcharts (needed so that we can add patterns)
    <script type="text/javascript" src="/apps/2.1/lib/analytics/analytics-all.js"></script>
    -->


    <script type="text/javascript">
        Rally.onReady(function() {
            Ext.override(Rally.ui.gridboard.SharedViewComboBox,{_isViewPreference:function(a){return"preference"===a.self.typePath&&"View"===a.get("Type")&&a.get("AppId")==this.getContext().getAppId()},getSharedViewParam:function(){var a=parent.location.hash,b=a.match(/sharedViewId=(\d+)/);return b&&b[1]},_ensureLatestView:function(a){if(a.objectId&&a.versionId){var b=Ext.create("Deft.Deferred");this.store.model.load(a.objectId,{fetch:["VersionId","Value"],success:function(a){b.resolve(a)}}),this.store.on("load",function(){b.promise.then({success:function(b){b&&b.get("VersionId")!==a.versionId&&this._applyView(this._decodeValue(b))},scope:this})},this,{single:!0})}}}),Ext.define("Utils.AncestorPiAppFilter",{alias:"plugin.UtilsAncestorPiAppFilter",mixins:["Ext.AbstractPlugin","Rally.Messageable"],extend:"Ext.Component",statics:{RENDER_AREA_ID:"utils-ancestor-pi-app-filter"},config:{renderAreaId:"utils-ancestor-pi-app-filter",publisher:!1,allowNoEntry:!0,settingsConfig:{},ancestorLabel:"With ancestor",ancestorLabelWidth:110,ownerLabel:"and owned by",ownerOnlyLabel:"Owned by",ownerLabelWidth:110,labelStyle:"font-size: medium",singleRowMinWidth:840},portfolioItemTypes:[],readyDeferred:null,piTypesDeferred:null,isSubscriber:!1,changeSubscribers:[],publishedValue:{},constructor:function(a){this.callParent(arguments),this._setupPubSub(),Ext.tip.QuickTipManager.init()},initComponent:function(){this.callParent(arguments),this.addEvents("ready","select")},init:function(a){this.cmp=a,this.cmp.on("resize",this._onCmpResize,this),this.renderArea=this.cmp.down("#"+this.renderAreaId);var b=this.cmp.getSettingsFields;this.cmp.getSettingsFields=function(){return this._getSettingsFields(b.apply(a,arguments))}.bind(this);var c=this.cmp.defaultSettings;c["Utils.AncestorPiAppFilter.enableAncestorPiFilter2"]=!1,c["Utils.AncestorPiAppFilter.projectScope"]="current",this.cmp.setDefaultSettings(c),this._addControlCmp().then({scope:this,success:function(){this._setReady()}})},notifySubscribers:function(){var a=this._getValue();_.each(this.changeSubscribers,function(b){this.publish(b,a)},this)},getFilterForType:function(a){var b,c=a.toLowerCase(),d=this._getValue();if(d.piTypePath){var e=d.piTypePath,f=d.isPiSelected,g=d.pi,h=this._piTypeAncestors(c,e);if(f&&null!=g&&null!=h){var i;i=this._propertyPrefix(c,h),i&&(b=new Rally.data.wsapi.Filter({property:i,value:g}))}else null!=g&&(b=new Rally.data.wsapi.Filter({property:"ObjectID",value:0}))}return b},getIgnoreProjectScope:function(){return this._getValue().ignoreProjectScope},_setupPubSub:function(){this.publisher?(this.subscribe(this,"registerChangeSubscriber",function(a){_.contains(this.changeSubscribers,a)||this.changeSubscribers.push(a),this.publish(a,this._getValue())},this),this.publish("reRegisterChangeSubscriber")):(this.subscriberEventName=Rally.getApp().getAppId()+this.$className,this.subscribe(this,this.subscriberEventName,function(a){this.intervalTimer&&(clearInterval(this.intervalTimer),delete this.intervalTimer),this.isSubscriber||(this.isSubscriber=!0,this._hideControlCmp()),this.publishedValue=a,this._onSelect()},this),this.publish("registerChangeSubscriber",this.subscriberEventName),this.intervalTimer=setInterval(function(){this.publish("registerChangeSubscriber",this.subscriberEventName)}.bind(this),500),this.subscribe(this,"reRegisterChangeSubscriber",function(){this.publish("registerChangeSubscriber",this.subscriberEventName)},this))},_getValue:function(){var a={};if(this._isSubscriber())a=this.publishedValue||{};else{if(this.piTypeSelector){var b=this.piTypeSelector.getRecord();if(b){var c=b.get("TypePath"),d=this.piSelector.getRecord(),e=this.piSelector.getValue();_.merge(a,{piTypePath:c,isPiSelected:!!d,pi:e})}}a.ignoreProjectScope=this._ignoreProjectScope()}return a},_setReady:function(){this.ready=!0,this.fireEvent("ready",this)},_onSelect:function(){this.ready&&this.fireEvent("select",this)},_getSettingsFields:function(a){var b=Rally.getApp().getSettings();b.hasOwnProperty("Utils.AncestorPiAppFilter.projectScope")||(b["Utils.AncestorPiAppFilter.projectScope"]="user");var c=[{xtype:"rallycheckboxfield",id:"Utils.AncestorPiAppFilter.enableAncestorPiFilter2",name:"Utils.AncestorPiAppFilter.enableAncestorPiFilter2",fieldLabel:"Filter artifacts by ancestor portfolio item"},{xtype:"rallyportfolioitemtypecombobox",id:"Utils.AncestorPiAppFilter.defaultPiType",name:"Utils.AncestorPiAppFilter.defaultPiType",fieldLabel:"Default Portfolio Item type",valueField:"TypePath",allowNoEntry:!1,defaultSelectionPosition:"last",plugins:[]},{xtype:"radiogroup",fieldLabel:"Show artifacts from",columns:1,vertical:!0,allowBlank:!1,items:[{boxLabel:"User's current project(s).",name:"Utils.AncestorPiAppFilter.projectScope",inputValue:"current",checked:"current"===b["Utils.AncestorPiAppFilter.projectScope"]},{boxLabel:"All projects in workspace.",name:"Utils.AncestorPiAppFilter.projectScope",inputValue:"workspace",checked:"workspace"===b["Utils.AncestorPiAppFilter.projectScope"]},{boxLabel:"User selectable (either current project(s) or all projects in workspace).",name:"Utils.AncestorPiAppFilter.projectScope",inputValue:"user",checked:"user"===b["Utils.AncestorPiAppFilter.projectScope"]}],listeners:{scope:this,change:function(a,b){}}}];return c=_.map(c,function(a){return _.merge(a,this.settingsConfig)},this),c.concat(a||[])},_addControlCmp:function(){var a=Ext.create("Deft.Deferred"),b={type:"hbox",align:"middle",defaultMargins:"0 10 0 0"},c=this.ownerLabelWidth;this.cmp.getWidth()<this.singleRowMinWidth&&(b="vbox",c=this.ancestorLabelWidth);var d=!1;0==this._showAncestorFilter()&&1==this._showIgnoreProjectScopeControl()&&(d=!0);var e={xtype:"container",id:"controlsArea",overflowX:"auto",layout:{type:"hbox",align:"top"},items:[{xtype:"container",id:"pubSubIndicatorArea",width:25,padding:"6 5 0 0",hidden:!this.publisher&&!this._isSubscriber(),items:[{xtype:"component",id:"publisherIndicator",html:'<span class="icon-bullhorn icon-large"></span>',hidden:!this.publisher},{xtype:"component",id:"subscriberIndicator",html:'<span class="icon-link icon-large"></span>',hidden:!this._isSubscriber()}]},{xtype:"container",id:"filtersArea",layout:b,items:[{xtype:"container",id:"ancestorFilterArea",layout:{type:"hbox",align:"middle"},items:[{xtype:"container",id:"piTypeArea",layout:{type:"hbox",align:"middle"}},{xtype:"container",id:"piSelectorArea",layout:{type:"hbox",align:"middle",padding:"0 0 0 5"}}]},{xtype:"container",id:"scopeControlArea",width:250,layout:{type:"hbox",align:"middle"},items:[{xtype:"rallycombobox",id:"ignoreScopeControl",stateful:!0,stateId:this.cmp.getContext().getScopedStateId("Utils.AncestorPiAppFilter.ignoreProjectScopeControl"),stateEvents:["select"],hidden:this._isSubscriber()||!this._showIgnoreProjectScopeControl(),displayField:"text",valueField:"value",labelStyle:this.labelStyle,labelWidth:c,fieldLabel:d?this.ownerOnlyLabel:this.ownerLabel,storeConfig:{fields:["text","value"],data:[{text:"Current Project(s)",value:!1},{text:"Any Project",value:!0}]},listeners:{scope:this,change:function(a,b){this._onSelect()}}}]}]}]};return this.renderArea&&(this.renderArea.setOverflowXY("auto","auto"),this.renderArea.add(e)),this._addTooltips(),Rally.data.util.PortfolioItemHelper.getPortfolioItemTypes().then({scope:this,success:function(b){this.portfolioItemTypes=b,!this._isSubscriber()&&this._showAncestorFilter()?(this.piTypeSelector=Ext.create("Rally.ui.combobox.PortfolioItemTypeComboBox",{xtype:"rallyportfolioitemtypecombobox",id:"Utils.AncestorPiAppFilter.piType",name:"Utils.AncestorPiAppFilter.piType",width:250,plugins:[],stateful:!0,stateId:this.cmp.getContext().getScopedStateId("Utils.AncestorPiAppFilter.piType"),stateEvents:["select"],fieldLabel:this.ancestorLabel,labelWidth:this.ancestorLabelWidth,labelStyle:this.labelStyle,valueField:"TypePath",value:this._defaultPortfolioItemType(),allowNoEntry:!1,defaultSelectionPosition:"first",listeners:{scope:this,ready:function(b){b.addListener({scope:this,change:this._onPiTypeChange}),this._addPiSelector(b.getValue()).then({scope:this,success:function(){a.resolve()}})}}}),this.renderArea.down("#piTypeArea").add(this.piTypeSelector)):a.resolve()}}),a.promise},_addTooltips:function(){Ext.tip.QuickTipManager.register({target:"publisherIndicator",text:'This app broadcasts filter settings to any enabled ancestor filtered apps (indicated with <span class="icon-link icon-large"></span>)',showDelay:50,border:!0}),Ext.tip.QuickTipManager.register({target:"subscriberIndicator",text:'This app listens for filter settings from any enabled ancestor filter broadcast app (indicated with <span class="icon-bullhorn icon-large"></span>)',showDelay:50,border:!0})},_onCmpResize:function(a,b){var c={type:"hbox",align:"middle",defaultMargins:"0 10 0 0"};b<this.singleRowMinWidth&&(c={type:"vbox"});var d=this.renderArea.down("#filtersArea");if(d){var e=this.renderArea.down("#controlsArea"),f=d.removeAll(!1),g={xtype:"container",id:"filtersArea",layout:c,items:f,hidden:d.isHidden()};e.remove(d,!1),e.add(g)}},_hideControlCmp:function(){this.renderArea&&(this.renderArea.down("#pubSubIndicatorArea").show(),this.renderArea.down("#subscriberIndicator").show(),this.renderArea.down("#filtersArea").hide())},_onPiTypeChange:function(a,b,c){b&&(this._removePiSelector(),this._addPiSelector(b).then({scope:this,success:function(){this._setReady()}}))},_removePiSelector:function(){this.renderArea.down("#piSelectorArea").removeAll()},_addPiSelector:function(a){var b=Ext.create("Deft.Deferred");return this.piSelector=Ext.create("Rally.ui.combobox.ArtifactSearchComboBox",{id:"Utils.AncestorPiAppFilter.piSelector",width:250,labelAlign:"top",storeConfig:{models:a,autoLoad:!0,context:{project:null}},stateful:!0,stateId:this.cmp.getContext().getScopedStateId("Utils.AncestorPiAppFilter.piSelector"),stateEvents:["select"],valueField:"_ref",allowClear:!0,clearValue:null,allowNoEntry:this.allowNoEntry,noEntryValue:"",defaultSelectionPosition:null,listeners:{scope:this,select:function(a,b){this._onSelect()},ready:function(a,c){b.resolve()}}}),Ext.override(this.piSelector,{saveState:function(){var a,b=this,c=b.stateful&&b.getStateId(),d=b.hasListeners;c&&(a=b.getState()||{},d.beforestatesave&&b.fireEvent("beforestatesave",b,a)===!1||(Ext.state.Manager.set(c,a),d.statesave&&b.fireEvent("statesave",b,a)))}}),this.renderArea.down("#piSelectorArea").add(this.piSelector),b.promise},_showAncestorFilter:function(){return this.cmp.getSetting("Utils.AncestorPiAppFilter.enableAncestorPiFilter2")},_showIgnoreProjectScopeControl:function(){return"user"==this.cmp.getSetting("Utils.AncestorPiAppFilter.projectScope")},_ignoreProjectScope:function(){var a=!1;return this._showIgnoreProjectScopeControl()?a=this.renderArea.down("#ignoreScopeControl").getValue():"workspace"==this.cmp.getSetting("Utils.AncestorPiAppFilter.projectScope")&&(a=!0),a},_isSubscriber:function(){return this.isSubscriber},_defaultPortfolioItemType:function(){return this.cmp.getSetting("Utils.AncestorPiAppFilter.defaultPiType")},_propertyPrefix:function(a,b){var c;return"hierarchicalrequirement"===a||"userstory"===a?c=b[0].get("Name"):"defect"===a?c="Requirement."+b[0].get("Name"):Ext.String.startsWith(a,"portfolioitem")&&(c="Parent"),c&&_.forEach(b.slice(1),function(a){c+=".Parent"},this),c},_piTypeAncestors:function(a,b){var c,d,e=null;return _.contains(["hierarchicalrequirement","userstory","defect"],a)?(c=_.findIndex(this.portfolioItemTypes,function(a){return a.get("TypePath").toLowerCase()===b.toLowerCase()}),e=this.portfolioItemTypes.slice(0,c+1)):Ext.String.startsWith(a,"portfolioitem")&&(d=_.findIndex(this.portfolioItemTypes,function(b){return b.get("TypePath").toLowerCase()===a.toLowerCase()}),c=_.findIndex(this.portfolioItemTypes,function(a){return a.get("TypePath").toLowerCase()===b.toLowerCase()}),c>d&&(e=this.portfolioItemTypes.slice(d+1,c+1))),e}}),Rally.ui.renderer.GridEditorFactory.editorRenderers.PreliminaryEstimate=function(a){return{xtype:"rallyrecordcontexteditor",field:{xtype:"rallycombobox",allowNoEntry:!a.required,editable:!1,name:a.name,storeConfig:{autoLoad:!0,model:a.name,remoteFilter:!0,sorters:[{property:"Value"}],listeners:{load:function(){}}}}}},Ext.define("Utils.AncestorPiInlineFilter",{override:"Rally.ui.inlinefilter.QuickFilterPanel",portfolioItemTypes:[],modelName:void 0,customFilterNamePrefix:"AncestorPiInlineFilter.",_hasPiAncestor:function(a){return _.contains(["hierarchicalrequirement","userstory","defect"],a)||Ext.String.startsWith(a,"portfolioitem")},_pisAbove:function(a){var b=[];if(_.contains(["hierarchicalrequirement","userstory","defect"],a))b=this.portfolioItemTypes;else if(Ext.String.startsWith(a,"portfolioitem")){var c=_.findIndex(this.portfolioItemTypes,function(b){return b.get("TypePath").toLowerCase()===a});c>=0&&c<this.portfolioItemTypes.length-1&&(b=this.portfolioItemTypes.slice(c+1))}return b},initComponent:function(){this.dataContext||(this.dataContext=Rally.getApp().getContext().getDataContext()),this.modelName&&(this.modelName=this.modelName.toLowerCase());var a={},b=[];if(this._hasPiAncestor(this.modelName)){var c=this._pisAbove(this.modelName);_.each(c,function(d){var e=d.get("TypePath"),f=this.customFilterNamePrefix+e,g="Portfolio Item / "+d.get("Name");a[f]={xtype:"ancestorpisearchcombobox",portfolioItemType:e,piTypesAbove:c,artifactTypeName:this.modelName,storeConfig:{context:this.dataContext,models:e,autoLoad:!0},allowNoEntry:!0,noEntryValue:null,noEntryText:"No "+g,emptyText:"Search "+g+"s...",allowClear:!1,valueField:"ObjectUUID",forceSelection:!1},b.push({name:f,displayName:g})},this),_.merge(this.addQuickFilterConfig,{additionalFields:b},function(a,b){return _.isArray(a)?_.uniq(a.concat(b),"name"):void 0}),Ext.override(Rally.ui.inlinefilter.FilterFieldFactory,a)}this.callParent(arguments)},_createFields:function(){this.fields=_.filter(this.fields,function(a){return this._filterInvalidAncestorFilters(a)},this),this.initialFilters=_.filter(this.initialFilters,function(a){return this._filterInvalidAncestorFilters(a.name)},this),this.callParent(arguments)},_filterInvalidAncestorFilters:function(a){return!Ext.String.startsWith(a,this.customFilterNamePrefix)||Rally.ui.inlinefilter.FilterFieldFactory.hasOwnProperty(a)}}),Ext.define("Utils.AncestorPiSearchComboBox",{alias:"widget.ancestorpisearchcombobox",extend:"Rally.ui.combobox.ArtifactSearchComboBox",parentField:"PortfolioItem.Parent.",artifactTypeName:void 0,piTypesAbove:[],statics:{UUID_REGEX:/([a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12})/},constructor:function(a){return a.value&&Ext.merge(a,{storeConfig:{filters:Rally.data.wsapi.Filter.or([{property:a.valueField,value:a.value}])}}),this.superclass.superclass.constructor.apply(this,arguments)},initComponent:function(){return this.on("change",function(a,b,c){""==b&&this.store.load({filters:[]})},this),this.callParent(arguments)},setValue:function(){this.callParent(arguments)},getFilter:function(){var a=this.lastValue,b=this.propertyPrefix(),c=[];return a&&this.statics().UUID_REGEX.test(a)?c.push({property:b+".ObjectUUID",value:a}):c.push({property:b,value:null}),Rally.data.wsapi.Filter.or(c)},propertyPrefix:function(){var a;return"hierarchicalrequirement"===this.artifactTypeName||"userstory"===this.artifactTypeName?a=this.piTypesAbove[0].get("Name"):"defect"===this.artifactTypeName?a="Requirement."+this.piTypesAbove[0].get("Name"):Ext.String.startsWith(this.artifactTypeName,"portfolioitem")&&(a="Parent"),a&&_.forEach(this.piTypesAbove,function(b){return b.get("TypePath").toLowerCase()==this.portfolioItemType.toLowerCase()?!1:void(a+=".Parent")},this),a}}),Ext.define("Rally.technicalservices.InfoLink",{extend:"Rally.ui.dialog.Dialog",alias:"widget.tsinfolink",informationHtml:null,title:"Build Information",defaults:{padding:5,margin:5},closable:!0,draggable:!0,autoShow:!0,width:350,initComponent:function(){Ext.id(this);this.title="<span class='icon-help'> </span>"+this.title,this.callParent(arguments)},_generateChecksum:function(a){var b,c=305419896;for(a=a.replace(/var CHECKSUM = .*;/,""),a=a.replace(/\s/g,""),b=0;b<a.length;b++)c+=a.charCodeAt(b)*b;return c},_checkChecksum:function(a){var b=Ext.create("Deft.Deferred");console.log("_checkChecksum",a);var c=this;return Ext.Ajax.request({url:document.URL,params:{id:1},success:function(a){return text=a.responseText,CHECKSUM&&CHECKSUM!==c._generateChecksum(text)?(console.log("Checksums don't match!"),void b.resolve(!1)):void b.resolve(!0)}}),b.promise},afterRender:function(){var a=Rally.getApp();a.isExternal()?this.addDocked({xtype:"container",cls:"build-info",padding:2,html:"... Running externally"}):this._checkChecksum(a).then({scope:this,success:function(a){a||this.addDocked({xtype:"container",cls:"build-info",padding:2,html:'<span class="icon-warning"> </span>Checksums do not match'})},failure:function(a){console.log("oops:",a)}}),this.callParent(arguments)},beforeRender:function(){this.callParent(arguments),this.informationHtml&&this.addDocked({xtype:"component",componentCls:"intro-panel",padding:2,html:this.informationHtml}),this.addDocked({xtype:"container",cls:"build-info",padding:2,html:"This app was created by the Rally Technical Services Team."}),APP_BUILD_DATE&&this.addDocked({xtype:"container",cls:"build-info",padding:2,html:"Build date/time: "+APP_BUILD_DATE})}}),Ext.define("Rally.technicalservices.Logger",{constructor:function(a){Ext.apply(this,a)},log:function(a){}}),Ext.define("Rally.technicalservices.HierarchyExporter",{logger:new Rally.technicalservices.Logger,mixins:{observable:"Ext.util.Observable"},records:void 0,constructor:function(a){this.mixins.observable.constructor.call(this,a),this.modelName=a.modelName,this.records=[],this.fileName=a.fileName||"export.csv",this.columns=a.columns||[{dataIndex:"FormattedID",text:"ID"},{dataIndex:"Name",text:"Name"}],this.portfolioItemTypeObjects=a.portfolioItemTypeObjects||[]},setRecords:function(a,b){this.records=(this.records||[]).concat(b)},"export":function(){this.fireEvent("exportupdate","Preparing export data"),this.logger.log("export",this.records,this);var a=this.columns,b=this._buildHierarchy(),c=this._getExportableHierarchicalData(b,a),d=this.modelName.toLowerCase();b.length>0&&(d=b[0]._type),a=this._getAncestorTypeColumns(d).concat(a);var e=this._transformDataToDelimitedString(c,a);this.saveCSVToFile(e,this.fileName),this.fireEvent("exportcomplete")},_buildHierarchy:function(){var a=[];this.logger.log("_buildHierarchy",this.records.length);var b=_.reduce(this.records,function(a,b){var c=b.get("ObjectID");return a[c]=b.getData(),a[c].loadedChildren=[],a},{});this.logger.log("_buildhierarchy Hash",b),this.records=null;for(var c in b){var d=b[c],e=d.Parent&&d.Parent.ObjectID||d.PortfolioItem&&d.PortfolioItem.ObjectID||d.WorkProduct&&d.WorkProduct.ObjectID||d.Requirement&&d.Requirement.ObjectID||d.TestCase&&d.TestCase.ObjectID;if(e&&b[e])b[e].loadedChildren.push(d);else{var f=d.Parent&&d.Parent.Parent&&d.Parent.Parent.ObjectID||null;f&&b[f]?b[f].loadedChildren.push(d):a.push(d)}}return a},_transformDataToDelimitedString:function(a,b){var c=[],d=",",e="\r\n",f=new RegExp(d+'|"|\r|\n',"g"),g=new RegExp("</?[^>]+>","g"),h=new RegExp("&nbsp;","ig"),i=_.map(b,function(a){return a.dataIndex}),j=_.pluck(b,"text");return c.push(j.join(d)),Ext.Array.each(a,function(a){var b=[];Ext.Array.each(i,function(c){var e=a[c];console.log("key",c),console.log("value",e),console.log("re",f),"Parent"===c&&(e=a[c]||a.PortfolioItem),e&&(g.test(e)&&(e=e.replace("<br>","\r\n"),this.logger.log("html val",e),e=Ext.util.Format.htmlDecode(e),e=Ext.util.Format.stripTags(e),this.logger.log("stripped html val",e)),h.test(e)&&(e=e.replace(h," ")),(f.test(e)||e.toString().search(d)>0)&&(console.log("inside",e),e=e.replace(/\"/g,'""'),e=Ext.String.format('"{0}"',e)),console.log("val escaped",e)),b.push(e)},this),c.push(b.join(d))},this),c.join(e)},_getExportableHierarchicalData:function(a,b){var c=[];return _.each(a,function(a){var d={},e=this._getExportDataRow(a,b,d);c.push(e),this._addExportChildren(a,c,b,d)},this),c},_addExportChildren:function(a,b,c,d){var e=Ext.clone(d),f=this;Ext.isEmpty(e[a._type])&&(e[a._type]=a.FormattedID);var g=a.loadedChildren;g&&g.length>0&&_.each(g,function(a){var d=this._getExportDataRow(a,c,e),g=d._type;Ext.isEmpty(e[g])||(d[g]=e[g]),b.push(d),f._addExportChildren(a,b,c,e)},this)},getTypePathDisplayName:function(a){if("hierarchicalrequirement"===a.toLowerCase())return"User Story";if("task"===a.toLowerCase())return"Task";if("defect"===a.toLowerCase())return"Defect";if("testcase"===a.toLowerCase())return"Test Case";var b="";return Ext.Array.each(this.portfolioItemTypeObjects,function(c){return c.get("TypePath").toLowerCase()===a.toLowerCase()?(b=c.get("Name"),!1):void 0}),b},_getExportDataRow:function(a,b,c){var d=Ext.clone(c),e=a._type;return d[e]=a.FormattedID,d.type=this.getTypePathDisplayName(a._type),d._type=a._type,_.each(b,function(b){var c=b.dataIndex||null;if(c){var e=a[c];if("Parent"===c&&(e=a[c]||a.PortfolioItem),Ext.isObject(e))if(e._tagsNameArray&&e._tagsNameArray.length>0){var f=_.pluck(e._tagsNameArray,"Name");d[c]=f.join(",")}else e.FormattedID?d[c]=e.FormattedID+": "+e._refObjectName:d[c]=e._refObjectName;else Ext.isDate(e)?d[c]=Rally.util.DateTime.formatWithDefaultDateTime(e):d[c]=e}}),d},_getAncestorTypeColumns:function(a){var b=a.toLowerCase(),c=[];if("hierarchicalrequirement"==b||Ext.String.startsWith(b,"portfolioitem")){var d=this.portfolioItemTypeObjects,e=-1;Ext.Array.each(d,function(b,c){b.get("TypePath").toLowerCase()===a.toLowerCase()&&(e=c)}),c.push({dataIndex:"hierarchicalrequirement",text:"User Story"}),e>=0&&(c=c.concat(Ext.Array.map(d.slice(0,e+1),function(a){return{dataIndex:a.get("TypePath").toLowerCase(),text:a.get("Name")}})),c.push({dataIndex:"type",text:"Artifact Type"})),c.reverse()}return c},saveCSVToFile:function(a,b,c){void 0===c&&(c={type:"text/csv;charset=utf-8"}),this.saveAs(a,b,c)},saveAs:function(a,b){if(Ext.isIE9m)return void Rally.ui.notify.Notifier.showWarning({message:"Export is not supported for IE9 and below."});var c=null;try{c=new Blob([a],{type:"text/plain"})}catch(d){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,window.BlobBuilder&&"TypeError"==d.name&&(bb=new BlobBuilder,bb.append([a]),c=bb.getBlob("text/plain"))}if(!c)return void Rally.ui.notify.Notifier.showWarning({message:"Export is not supported for this browser."});var e=b;if(Ext.isIE10p)return void window.navigator.msSaveOrOpenBlob(c,e);var f=this.createObjectURL(c);if(f){var g=document.createElement("a");"download"in g?g.download=e:g.target="_blank",g.innerHTML="Download File",g.href=f,Ext.isChrome||(g.onclick=this.destroyClickedElement,g.style.display="none",document.body.appendChild(g)),g.click()}else Rally.ui.notify.Notifier.showError({message:"Export is not supported "})},createObjectURL:function(a){return window.webkitURL?window.webkitURL.createObjectURL(a):window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(a):null},destroyClickedElement:function(a){document.body.removeChild(a.target)}}),Ext.define("Rally.technicalservices.HierarchyLoader",{logger:new Rally.technicalservices.Logger,storyModelName:"hierarchicalrequirement",taskModelName:"task",mixins:{observable:"Ext.util.Observable"},model:void 0,filters:void 0,fetch:void 0,childModels:void 0,sorters:void 0,maxParallelCalls:6,constructor:function(a){this.mixins.observable.constructor.call(this,a),this.portfolioItemTypes=a.portfolioItemTypes||[],this.model=a.model||null,this.fetch=a.fetch||[],this.filters=a.filters||[],this.loadChildModels=a.loadChildModels||[],this.sorters=a.sorters||[]},load:function(){if(!this.model)return void this.fireEvent("hierarchyloaderror","No model specified.");if(0===this.portfolioItemTypes.length)return void this.fireEvent("hierarchyloaderror","Portfolio Item Types not initialized.");if(!(this.loadChildModels instanceof Array))return void this.fireEvent("hierarchyloaderror","No child models specified.");for(var a=[],b=0;b<this.loadChildModels.length+4;b++)a.push(this.fetchNextLevel);Deft.Chain.pipeline(a,this).then({success:function(){this.fireEvent("hierarchyloadcomplete")},failure:function(a){this.fireEvent("hierarchyloaderror",a)},scope:this})},fetchNextLevel:function(a){if(this.logger.log("fetchNextLevel",a,a&&a.length),!a)return this.fetchRoot();if(a=_.flatten(a),this.logger.log("fetchNextLevel flattened args",a,a.length),a.length>0&&Ext.isFunction(a[0].get)){var b=a[0].get("_type"),c=Ext.Array.unique(Ext.Array.map(a,function(a){return a.get("_type")}));this.fireEvent("hierarchyloadartifactsloaded",b,a);var d=_.map(this.portfolioItemTypes,function(a){return a.get("TypePath").toLowerCase()}),e=_.indexOf(d,b);return 0===e&&Ext.Array.contains(this.loadChildModels,this.storyModelName)?this.fetchUserStories(a):e>0&&Ext.Array.contains(this.loadChildModels,d[e-1])?this.fetchPortfolioItems(d[e-1],a):this.fetchChildrenFromMultipleTypes(c,a)}return[]},fetchRoot:function(){var a=this.fetch.concat(this.getRequiredFetchFields(this.model));this.fireEvent("statusupdate","Loading artifacts");var b={model:this.model,fetch:a,filters:this.filters,sorters:this.sorters,context:this.context};return this.logger.log("fetchRoot config",b),this.fetchWsapiRecords(b)},fetchPortfolioItems:function(a,b){var c=this.fetch.concat(this.getRequiredFetchFields(a)),d=this._getChunks(b,"Children","Count");return this.fetchChunks(a,c,d,"Parent.ObjectID",Ext.String.format("Please Wait... Loading Children for {0} Portfolio Items",b.length))},_getChunks:function(a,b,c){this.logger.log("_getChunks",a,b,c);var d=[],e=0,f=100,g=200,h=0;return d[h]=[],_.each(a,function(a){var i=a.get(b);c&&i&&(i=i[c]),i>0&&(e+=i,(e>g||d[h].length>=f)&&(h++,d[h]=[],e=0),d[h].push(a.get("ObjectID")))}),d},fetchUserStories:function(a){var b=this.storyModelName,c=this.fetch.concat(this.getRequiredFetchFields(b)),d=this._getChunks(a,"LeafStoryCount"),e=this.portfolioItemTypes[0].get("Name").replace(/\s/g,"")+".ObjectID";return this.fetchChunks(b,c,d,e,Ext.String.format("Please Wait... Loading User Stories for {0} Portfolio Items",a.length))},fetchChildrenFromMultipleTypes:function(a,b){this.logger.log("fetchChildrenFromMultipleTypes",a,b);var c=[];return Ext.Array.map(a,function(a){if(child_types=this.getAllowedChildTypes(a),child_types.length>0){var d=Ext.Array.filter(b,function(b){return b.get("_type")==a},this);c.push(function(){return this.fetchChildrenOfMultipleTypes(d)})}},this),0===c.length?[]:Deft.Chain.sequence(c,this)},fetchChildrenOfMultipleTypes:function(a){var b=a[0].get("_type"),c=this.getAllowedChildTypes(b);this.logger.log("fetchChildrenOfMultipleTypes",c,a);var d=Ext.Array.map(c,function(b){return function(){return this.fetchChildren(b,a)}},this);return Deft.Chain.sequence(d,this)},fetchChildren:function(a,b){this.logger.log("fetchChildren",a,b);var c=this.fetch.concat(this.getRequiredFetchFields(a)),d=b[0].get("_type"),e=this.getChildFieldFor(d,a),f=this._getChunks(b,e,"Count"),g=this.getParentFieldFor(a,d);return this.fetchChunks(a,c,f,g+".ObjectID",Ext.String.format("Please Wait... Loading {0} for {1} items",e,b.length))},fetchChunks:function(a,b,c,d,e){if(this.logger.log("fetchChunks",b,d,c),!c||0===c.length)return[];if(0===c[0].length)return[];this.fireEvent("statusupdate",e);var f=[];return _.each(c,function(c){var e=_.map(c,function(a){return{property:d,value:a}}),g={model:a,fetch:b,sorters:[{property:"TaskIndex",direction:"ASC"},{property:"DragAndDropRank",direction:"ASC"}],filters:Rally.data.wsapi.Filter.or(e),context:{project:null}};f.push(function(){return this.fetchWsapiRecords(g)})}),this.throttle(f,this.maxParallelCalls,this)},fetchWsapiRecords:function(a){var b=Ext.create("Deft.Deferred");return a.compact=!1,a.limit="Infinity",a.allowPostGet=!0,Ext.create("Rally.data.wsapi.Store",a).load({callback:function(a,c){c.wasSuccessful()?b.resolve(a):b.reject("fetchWsapiRecords error: "+c.error.errors.join(","))},scope:this}),b},getChildFieldFor:function(a,b){if("hierarchicalrequirement"===a.toLowerCase()||"userstory"===a.toLowerCase()){if("task"==b.toLowerCase())return"Tasks";if("defect"==b.toLowerCase())return"Defects";if("testcase"==b.toLowerCase())return"TestCases";if("hierarchicalrequirement"==b.toLowerCase())return"Children"}if("defect"===a.toLowerCase()){if("task"==b.toLowerCase())return"Tasks";if("testcase"==b.toLowerCase())return"TestCases"}return"testcase"===a.toLowerCase()&&"defect"==b.toLowerCase()?"Defects":/portfolioitem/.test(a.toLowerCase())&&"hierarchicalrequirement"==b.toLowerCase()?"UserStories":null},getParentFieldFor:function(a,b){if("hierarchicalrequirement"===b.toLowerCase()||"userstory"===b.toLowerCase()){if("task"==a.toLowerCase())return"WorkProduct";if("defect"==a.toLowerCase())return"Requirement";if("testcase"==a.toLowerCase())return"WorkProduct";if("hierarchicalrequirement"==a.toLowerCase())return"Parent"}if("defect"===b.toLowerCase()){if("task"==a.toLowerCase())return"WorkProduct";if("testcase"==a.toLowerCase())return"WorkProduct"}return"testcase"===b.toLowerCase()&&"defect"==a.toLowerCase()?"TestCase":/portfolioitem/.test(b.toLowerCase())&&"hierarchicalrequirement"==a.toLowerCase()?"PortfolioItem":null},getAllowedChildTypes:function(a){var b=[],c=this.loadChildModels;a.toLowerCase()===this.storyModelName.toLowerCase()&&(b=["task","defect","testcase",this.storyModelName.toLowerCase()]),"defect"===a.toLowerCase()&&(b=["task","testcase"]),"testcase"===a.toLowerCase()&&(b=["defect"]);var d=Ext.Array.intersect(b,c);return d},getRequiredFetchFields:function(a){return/^portfolioitem/.test(a.toLowerCase())?["Children","LeafStoryCount","Parent","ObjectID","UserStories"]:a.toLowerCase()===this.storyModelName?["FormattedID","Children","Tasks","Parent","PortfolioItem","HasParent","ObjectID","TestCases","Defects"]:["ObjectID","WorkProduct","Defects","Tasks","TestCases","Requirement","TestCase","FormattedID"]},throttle:function(a,b,c){if(0>=b||a.length<b)return Deft.promise.Chain.parallel(a,c);for(var d=[],e=[],f=-1,g=0;g<a.length;g++)g%b===0&&(f++,e[f]=[]),e[f].push(a[g]);return _.each(e,function(a){d.push(function(){return Deft.promise.Chain.parallel(a,c)})}),Deft.Promise.reduce(d,function(a,b){return Deft.Promise.when(b.call(c)).then(function(b){return a=a.concat(b||[])})},[])}}),Ext.override(Rally.ui.gridboard.plugin.GridBoardFieldPicker,{gridFieldBlackList:["Changesets","Children","ObjectID","Predecessors","RevisionHistory","Subscription","Successors","TaskIndex","Workspace","VersionId"]}),Ext.override(Rally.ui.inlinefilter.PropertyFieldComboBox,{defaultWhiteListFields:["Milestones","Tags"]}),Ext.override(Rally.ui.grid.TreeGrid,{_mergeColumnConfigs:function(a,b){return _.map(a,function(a){var c=a,d=this._getColumnName(a),e=_.find(b,{dataIndex:d});if(e)c=this._getColumnConfigFromColumn(e);else if(this.config&&this.config.columnCfgs){var f=_.find(this.config.columnCfgs,{dataIndex:d});f&&(c=f)}return c},this)},_applyStatefulColumns:function(a){this.alwaysShowDefaultColumns&&_.each(this.columnCfgs,function(b){_.any(a,{dataIndex:this._getColumnName(b)})||a.push(b)},this),this.config&&this.config.columnCfgs&&_.each(this.config.columnCfgs,function(b){var c=this._getColumnName(b),d=_.find(a,function(a){return a.dataIndex===c||a.text===c});d&&_.merge(d,b)},this),this.columnCfgs=a}}),function(){var a=window.Ext4||window.Ext,b=function(a){return{name:a,xtype:"rallytextfield",hidden:!0,handlesEvents:{typeselected:function(a){this.setValue(null)}}}};a.define("Rally.technicalservices.CustomGridWithDeepExportSettings",{singleton:!0,requires:["Rally.ui.combobox.FieldComboBox","Rally.ui.combobox.ComboBox","Rally.ui.CheckboxField"],getFields:function(){Rally.data.wsapi.Filter.or([{property:"TypePath",value:"HierarchicalRequirement"},{property:"TypePath",operator:"contains",value:"PortfolioItem/"}]);return[{name:"type",xtype:"rallycombobox",allowBlank:!1,autoSelect:!1,shouldRespondToScopeChange:!0,initialValue:"HierarchicalRequirement",storeConfig:{model:a.identityFn("TypeDefinition"),
sorters:[{property:"DisplayName"}],fetch:["DisplayName","ElementName","TypePath","Parent","UserListable"],filters:[{property:"UserListable",value:!0}],autoLoad:!1,remoteSort:!1,remoteFilter:!0},displayField:"DisplayName",valueField:"TypePath",listeners:{select:function(a){a.fireEvent("typeselected",a.getRecord().get("TypePath"),a.context)}},bubbleEvents:["typeselected"],readyEvent:"ready",handlesEvents:{projectscopechanged:function(a){this.refreshWithNewContext(a)}}},{type:"query"},{name:"showControls",xtype:"rallycheckboxfield",fieldLabel:"Show Control Bar"},{name:"enableUrlSharing",xtype:"rallycheckboxfield",fieldLabel:"Enable URL Sharing of Saved Views"},b("columnNames"),b("order")]}})}(),Ext.define("custom-grid-with-deep-export",{extend:"Rally.app.App",componentCls:"app",logger:new Rally.technicalservices.Logger,layout:{type:"vbox",align:"stretch"},items:[{id:Utils.AncestorPiAppFilter.RENDER_AREA_ID,xtype:"container",layout:{type:"hbox",align:"middle",defaultMargins:"0 10 10 0"}},{id:"grid-area",xtype:"container",flex:1,type:"vbox",align:"stretch"}],config:{defaultSettings:{columnNames:["FormattedID","Name","ScheduleState"],query:"",showControls:!0,type:"HierarchicalRequirement",pageSize:50,enableUrlSharing:!1}},integrationHeaders:{name:"custom-grid-with-deep-export"},disallowedAddNewTypes:["user","userprofile","useriterationcapacity","testcaseresult","task","scmrepository","project","changeset","change","builddefinition","build","program"],orderedAllowedPageSizes:[10,25,50,100,200],readOnlyGridTypes:["build","change","changeset"],statePrefix:"customlist",allowExpansionStateToBeSaved:!1,enableAddNew:!0,onTimeboxScopeChange:function(a){this.callParent(arguments),this._buildStore()},launch:function(){this.ancestorFilterPlugin=Ext.create("Utils.AncestorPiAppFilter",{ptype:"UtilsAncestorPiAppFilter",pluginId:"ancestorFilterPlugin",settingsConfig:{},listeners:{scope:this,ready:function(a){Rally.data.util.PortfolioItemHelper.getPortfolioItemTypes().then({scope:this,success:function(b){this.portfolioItemTypes=_.sortBy(b,function(a){return a.get("Ordinal")}),a.addListener({scope:this,select:this.viewChange}),this.viewChange()},failure:function(a){this._showError(a)}})}}}),this.addPlugin(this.ancestorFilterPlugin)},onResize:function(){this.callParent(arguments);var a=this.down("#grid-area"),b=this.down("rallygridboard");a&&b&&b.setHeight(a.getHeight())},_buildStore:function(){this.modelNames=[this.getSetting("type")],this.logger.log("_buildStore",this.modelNames);var a=["FormattedID","Name"],b=this.getContext().getDataContext();this.searchAllProjects()&&(b.project=null),Ext.create("Rally.data.wsapi.TreeStoreBuilder").build({models:this.modelNames,enableHierarchy:!0,remoteSort:!0,fetch:a,context:b}).then({success:this._addGridboard,scope:this})},_addGridboard:function(a){var b=this.down("#grid-area");b.removeAll();var c=this.modelNames[0],d=this.getSetting("query")?[Rally.data.wsapi.Filter.fromQueryString(this.getSetting("query"))]:[],e=this.getContext().getTimeboxScope();e&&e.isApplicable(a.model)&&d.push(e.getQueryFilter());var f=this.ancestorFilterPlugin.getFilterForType(c);f&&d.push(f),this.logger.log("_addGridboard",a);var g=this.getContext(),h=g.getDataContext();this.searchAllProjects()&&(h.project=null);var i=Ext.create("Rally.ui.grid.feature.SummaryRow");this.gridboard=b.add({xtype:"rallygridboard",context:g,modelNames:this.modelNames,toggleState:"grid",height:b.getHeight(),listeners:{scope:this,viewchange:this.viewChange},plugins:["rallygridboardaddnew",{ptype:"rallygridboardinlinefiltercontrol",inlineFilterButtonConfig:{stateful:!0,stateId:this.getModelScopedStateId(c,"filters"),modelNames:this.modelNames,inlineFilterPanelConfig:{quickFilterPanelConfig:{portfolioItemTypes:this.portfolioItemTypes,modelName:c,whiteListFields:["Tags","Milestones"]}}}},{ptype:"rallygridboardfieldpicker",headerPosition:"left",modelNames:this.modelNames,stateful:!0,stateId:this.getModelScopedStateId(c,"fields")},{ptype:"rallygridboardactionsmenu",menuItems:this._getExportMenuItems(),buttonConfig:{iconCls:"icon-export"}},{ptype:"rallygridboardsharedviewcontrol",sharedViewConfig:{enableUrlSharing:this.getSetting("enableUrlSharing"),stateful:!0,stateId:this.getModelScopedStateId(c,"views"),stateEvents:["select","beforedestroy"]}}],cardBoardConfig:{attribute:"ScheduleState"},gridConfig:{store:a,storeConfig:{filters:d,context:h},columnCfgs:["Name",{dataIndex:"PlanEstimate",summaryType:"sum"},{dataIndex:"TaskRemainingTotal",summaryType:"sum"},{dataIndex:"ToDo",summaryType:"sum"},{dataIndex:"TaskEstimateTotal",summaryType:"sum"}],features:[i]}})},viewChange:function(){this._buildStore()},getModelScopedStateId:function(a,b){return this.getContext().getScopedStateId(a+"-"+b)},_getExportMenuItems:function(){var a=[];this.logger.log("_getExportMenuItems",this.modelNames[0]);var b=this.modelNames[0].toLowerCase();if("hierarchicalrequirement"===b)a=[{text:"Export User Stories...",handler:this._export,scope:this,childModels:["hierarchicalrequirement"]},{text:"Export User Stories and Tasks...",handler:this._export,scope:this,childModels:["hierarchicalrequirement","task"]},{text:"Export User Stories and Child Items...",handler:this._export,scope:this,childModels:["hierarchicalrequirement","task","defect","testcase"]}];else if(Ext.String.startsWith(b,"portfolioitem")){var c=this.getPortfolioItemTypeNames(),d=_.indexOf(c,b),e=[];if(d>0)for(var f=d;f>0;f--)e.push(c[f-1]);a=[{text:"Export Portfolio Items...",handler:this._export,scope:this,childModels:e},{text:"Export Portfolio Items and User Stories...",handler:this._export,scope:this,childModels:e.concat(["hierarchicalrequirement"])},{text:"Export Portfolio Items, User Stories and Tasks...",handler:this._export,scope:this,childModels:e.concat(["hierarchicalrequirement","task"])},{text:"Export Portfolio Items and Child Items...",handler:this._export,scope:this,childModels:e.concat(["hierarchicalrequirement","task","defect","testcase"])}]}else a="defect"==b?[{text:"Export Defects...",handler:this._export,scope:this,childModels:[]},{text:"Export Defects and Child Items...",handler:this._export,scope:this,childModels:["defect","task","testcase"]}]:"testcase"==b?[{text:"Export Test Cases...",handler:this._export,scope:this,childModels:[]},{text:"Export Test Cases and Child Items...",handler:this._export,scope:this,childModels:["defect","task","testcase"]}]:[{text:"Export to CSV...",handler:this._export,scope:this,childModels:[]}];return a},getPortfolioItemTypeNames:function(){return _.map(this.portfolioItemTypes,function(a){return a.get("TypePath").toLowerCase()})},_showError:function(a){Rally.ui.notify.Notifier.showError({message:a})},_showStatus:function(a){this.logger.log("_showstatus",a,this),a?Rally.ui.notify.Notifier.showStatus({message:a,showForever:!0,closable:!1,animateShowHide:!1}):Rally.ui.notify.Notifier.hide()},_getExportColumns:function(){var a=this.down("rallygridboard").getGridOrBoard();return a?_.filter(a.columns,function(a){return a.dataIndex&&"DragAndDropRank"!=a.dataIndex&&a.xtype&&"rallytreerankdraghandlecolumn"!=a.xtype&&"rallyrowactioncolumn"!=a.xtype&&"&#160;"!=a.text}):[]},_getExportFilters:function(){var a=this.down("rallygridboard"),b=[],c=this.getSetting("query");a.currentCustomFilter&&a.currentCustomFilter.filters&&(b=b.concat(a.currentCustomFilter.filters)),c&&b.push(Rally.data.wsapi.Filter.fromQueryString(c));var d=this.getContext().getTimeboxScope();d&&d.isApplicable(a.getGridOrBoard().store.model)&&b.push(d.getQueryFilter());var e=this.ancestorFilterPlugin.getFilterForType(this.modelNames[0]);return e&&b.push(e),b},_getExportFetch:function(){var a=_.pluck(this._getExportColumns(),"dataIndex");return Ext.Array.contains(a,"TaskActualTotal")&&a.push("Actuals"),a},_getExportSorters:function(){return this.down("rallygridboard").getGridOrBoard().getStore().getSorters()},_export:function(a){var b=this._getExportColumns(),c=this._getExportFetch(),d=this._getExportFilters(),e=this.modelNames[0],f=a.childModels,g=this._getExportSorters();this.logger.log("_export",c,a,b,d.toString(),f,g);var h=Ext.create("Rally.technicalservices.HierarchyExporter",{modelName:e,fileName:"hierarchy-export.csv",columns:b,portfolioItemTypeObjects:this.portfolioItemTypes});h.on("exportupdate",this._showStatus,this),h.on("exporterror",this._showError,this),h.on("exportcomplete",this._showStatus,this);var i=this.getContext().getDataContext();this.searchAllProjects()&&(i.project=null);var j=Ext.create("Rally.technicalservices.HierarchyLoader",{model:e,fetch:c,filters:d,sorters:g,loadChildModels:f,portfolioItemTypes:this.portfolioItemTypes,context:i});j.on("statusupdate",this._showStatus,this),j.on("hierarchyloadartifactsloaded",h.setRecords,h),j.on("hierarchyloadcomplete",h["export"],h),j.on("hierarchyloaderror",this._showError,this),j.load()},getHeight:function(){var a=this.getEl();if(a){var b=this.callParent(arguments);return Ext.isIE8?Math.max(b,600):b}return 0},setHeight:function(a){this.callParent(arguments),this.gridboard&&this.gridboard.setHeight(a)},getOptions:function(){return[{text:"About...",handler:this._launchInfo,scope:this}]},_launchInfo:function(){this.about_dialog&&this.about_dialog.destroy(),this.about_dialog=Ext.create("Rally.technicalservices.InfoLink",{})},isExternal:function(){return"undefined"==typeof this.getAppId()},searchAllProjects:function(){return this.ancestorFilterPlugin.getIgnoreProjectScope()},getSettingsFields:function(){return Rally.technicalservices.CustomGridWithDeepExportSettings.getFields()}});

               Rally.launchApp('custom-grid-with-deep-export', {
                   name: 'custom-grid-with-deep-export'
               });
        });
    </script>

    <style type="text/css">

.app {
}
.tsinfolink {
    position:absolute;
    right:0px;
    width: 14px;
    height: 14px;
    border-radius: 7px;
    text-align: center;
    color: white;
    background: #C0C0C0;
    border-style: solid;
    border-width: 1px;
    margin-top: 25px;
    margin-right: 5px;
    cursor: pointer;
}
    </style>

</head>
<body></body>
</html>